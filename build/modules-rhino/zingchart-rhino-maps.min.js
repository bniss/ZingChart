/*
All of the code within the ZingChart software is developed and copyrighted by ZingChart, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from ZingChart. All usage must coincide with the
ZingChart End User License Agreement which can be requested by email at support@zingchart.com.

Build 2.9.0
*/
ZC.WI.push("maps"),zingchart.maps||(zingchart.maps={},zingchart.maps.maps={},zingchart.maps.data={}),zingchart.maps.FORCESCALE=0,zingchart.maps.CONNECTORS=1,zingchart.maps.LITE=0,zingchart.maps._DEFAULTS_={_COMMON_:{label:{"font-size":9,padding:"1 2",overlap:!1},tooltip:{"border-radius":6,"background-color":"#fff",color:"#303030","border-width":1,"border-color":"#909090",padding:10}},_POLY_:{alpha:.9,shadow:!0,"shadow-distance":3,"shadow-color":"#ccc","border-width":1,"border-color":"#a3a3a3","background-color":"#e3e3e3","hover-state":{shadow:!0,"background-color":"#d3d3d3","offset-x":-1,"offset-y":-1,"shadow-distance":3},connector:{"line-color":"#666","line-width":1}},_LINE_:{alpha:1,shadow:!1,"line-width":2,"line-color":"#4ea8fc","hover-state":{"line-color":"#4ec8cc","offset-x":0,"offset-y":0,shadow:!1}},_POINT_:{alpha:1,size:3,shadow:!1,"background-color":"#333","hover-state":{"offset-x":0,"offset-y":0,shadow:!1,"border-width":1,"border-color":"#aaa","background-color":"#666"},label:{"font-size":10,"offset-y":8}}},zingchart.maps.LIGHT={"background-color":"#fff",_COMMON_:{label:{"font-size":9,padding:"1 2"},tooltip:{"border-radius":6,"background-color":"#fff",color:"#303030","border-width":1,"border-color":"#909090",padding:10}},_POLY_:{alpha:1,"border-width":1,"border-color":"#fff","background-color":"#DDDDDD","hover-state":{"background-color":"#C4C4C4"},connector:{"line-color":"#666","line-width":1}},_LINE_:{alpha:1,shadow:!1,"line-width":2,"line-color":"#4ea8fc","hover-state":{"line-color":"#4ec8cc","offset-x":0,"offset-y":0,shadow:!1}},_POINT_:{alpha:1,size:3,shadow:!1,"background-color":"#333","hover-state":{"offset-x":0,"offset-y":0,shadow:!1,"border-width":1,"border-color":"#aaa","background-color":"#666"},label:{"font-size":10,"offset-y":8}}},zingchart.maps.DARK={"background-color":"#221F1F",_COMMON_:{label:{"font-size":9,padding:"1 2"},tooltip:{"border-radius":6,"background-color":"#fff",color:"#303030","border-width":1,"border-color":"#909090",padding:10}},_POLY_:{alpha:1,"border-width":1,"border-color":"#221F1F","background-color":"#DDDDDD","hover-state":{"background-color":"#C4C4C4"},connector:{"line-color":"#DDDDDD","line-width":1}},_LINE_:{alpha:1,shadow:!1,"line-width":2,"line-color":"#4ea8fc","hover-state":{"line-color":"#4ec8cc","offset-x":0,"offset-y":0,shadow:!1}},_POINT_:{alpha:1,size:3,shadow:!1,"background-color":"#333","hover-state":{"offset-x":0,"offset-y":0,shadow:!1,"border-width":1,"border-color":"#aaa","background-color":"#666"},label:{"font-size":10,"offset-y":8}}},zingchart.maps.upgrade=function(a){var o,t=zingchart.maps.data,e=a.split(".");1===e.length?t=t[a]:2===e.length&&(t=t[e[0]][e[1]]);for(var i in t)if("_GROUPS_"!==i&&"_DEFAULTS_"!==i&&"_RULES_"!==i&&null===ZC._n_(t[i].cpoint))if(null!==ZC._n_(t[i].label.x)&&null!==ZC._n_(t[i].label.y))t[i].cpoint={x:t[i].label.x,y:t[i].label.y};else{if("point"===t[i].type)o=t[i].coords[0];else if("line"===t[i].type){var r=ZC._i_(t[i].coords.length/2);o=t[i].coords[r]||t[i].coords[r+1]||t[i].coords[r-1]}else o=zingchart.maps.centroid(t[i].coords);t[i].cpoint={x:o[0].toFixed(4)+"lon",y:o[1].toFixed(4)+"lat"},t[i].label.x=o[0].toFixed(4)+"lon",t[i].label.y=o[1].toFixed(4)+"lat"}},zingchart.maps.centroid=function(a){var o,t,e,i,r=0,n=0,_=0;for(e=0,i=a.length;e<i-1;e++)null!==ZC._n_(o=a[e])&&null!==ZC._n_(t=a[e+1])&&(_+=o[0]*t[1]-t[0]*o[1],r+=(o[0]+t[0])*(o[0]*t[1]-t[0]*o[1]),n+=(o[1]+t[1])*(o[0]*t[1]-t[0]*o[1]));return _*=.5,r/=6*_,n/=6*_,[r,n,_]},zingchart.maps.getMapByGraphIndex=function(a,o){var t;for(var e in zingchart.maps.maps)if((t=zingchart.maps.maps[e])._INFO_.loaderid===a&&t._INFO_.graphinfo.graph.index===o)return t;return null},zingchart.maps.zoomIn=function(A50){var oMap=zingchart.maps.maps[A50]||eval("zingchart.maps.data."+A50);if(oMap&&oMap._INFO_){var fZoomRatio=1.25;oMap._INFO_.zoom*=fZoomRatio,zingchart.maps.setView(oMap._INFO_.loaderid,oMap._INFO_.id,oMap._INFO_.zoom,oMap._INFO_.offsetX,oMap._INFO_.offsetY)}},zingchart.maps.zoomOut=function(A50){var oMap=zingchart.maps.maps[A50]||eval("zingchart.maps.data."+A50);if(oMap&&oMap._INFO_){var H=zingchart.getLoader(oMap._INFO_.loaderid),C=H.AH[oMap._INFO_.graphinfo.graph.index],fZoomRatio=1.25,iCX=C.iX+C.I/2,iCY=C.iY+C.F/2,iMouseX=C.I/2,iMouseY=C.F/2,EA,aCP=[(oMap._INFO_.bbox[0]+oMap._INFO_.bbox[2])/2,(oMap._INFO_.bbox[1]+oMap._INFO_.bbox[3])/2],aLonLat=zingchart.maps.getLonLat(oMap._INFO_.id,[iMouseX,iMouseY]);if(oMap._INFO_.zoom=Math.max(.1,oMap._INFO_.zoom/fZoomRatio),oMap._INFO_.zoom>fZoomRatio)EA=zingchart.maps.getXY(oMap._INFO_.id,aLonLat),oMap._INFO_.offsetX-=EA[0]-iMouseX,oMap._INFO_.offsetY-=EA[1]-iMouseY;else{EA=zingchart.maps.getXY(oMap._INFO_.id,aCP);var OS=EA[0]-iCX,ZT=EA[1]-iCY/2;oMap._INFO_.offsetX=OS*((oMap._INFO_.zoom-1)/5),oMap._INFO_.offsetY=ZT*((oMap._INFO_.zoom-1)/5)}zingchart.maps.setView(oMap._INFO_.loaderid,oMap._INFO_.id,oMap._INFO_.zoom,oMap._INFO_.offsetX,oMap._INFO_.offsetY)}},zingchart.maps.destroyMap=function(a){delete zingchart.maps.maps[a]},zingchart.maps.setView=function(a,o,t,e,i){for(var r=zingchart.getLoader(a),n=0,_=0,s=0;s<r.o.graphset.length;s++)if(r.o.graphset[s].shapes)for(var l=0;l<r.o.graphset[s].shapes.length;l++)if("zingchart.maps"===r.o.graphset[s].shapes[l].type&&r.o.graphset[s].shapes[l].options&&(r.o.graphset[s].shapes[l].options.id===o||r.o.graphset[s].shapes[l].options.name===o)){n=s,_=l;break}var p=r.o.graphset[n].shapes[_];p.options=p.options||{},p.options.zoom=Math.abs(ZC._f_(t||"1")),p.options["offset-x"]=ZC._i_(e||"0"),p.options["offset-y"]=ZC._i_(i||"0"),p.options.style=p.options.style||{},p.options.style.label=p.options.style.label||{},null===ZC._n_(p.options.style.label.visible_)&&(p.options.style&&p.options.style.label?p.options.style.label.visible_=null===ZC._n_(p.options.style.label.visible)||p.options.style.label.visible:(p.options.style=p.options.style||{},p.options.style.label=p.options.style.label||{},p.options.style.label.visible_=!0)),zingchart.maps.SKIP_LABELS?p.options.style.label.visible=!1:(p.options.style.label.visible=null===ZC._n_(p.options.style.label.visible_)||p.options.style.label.visible_,p.options.style.label.visible_=null),r.clearGenerated(),zingchart.exec(a,"setdata",{data:r.o})},zingchart.bind(null,"shape_mouseover",function(a){var o=zingchart.getLoader(a.id),t=ZC.P.MA(a.ev),e=o.A4M(t[0],t[1]);if(e){var i=zingchart.maps.getMapByGraphIndex(a.id,e.L);i&&i._INFO_["color-scale"]&&zingchart.plugins.colorscale&&zingchart.plugins.colorscale.info&&zingchart.plugins.colorscale.info[a.id+"_"+e.L]&&zingchart.plugins.colorscale.AGD(a.id,{graphid:a.graphid,value:a["data-value"]})}}),zingchart.bind(null,"shape_mouseout",function(a){var o=zingchart.getLoader(a.id),t=ZC.P.MA(a.ev),e=o.A4M(t[0],t[1]);if(e){var i=zingchart.maps.getMapByGraphIndex(a.id,e.L);i&&i._INFO_["color-scale"]&&zingchart.plugins.colorscale&&zingchart.plugins.colorscale.info&&zingchart.plugins.colorscale.info[a.id+"_"+e.L]&&zingchart.plugins.colorscale.clear(a.id,{graphid:a.graphid})}}),zingchart.bind(null,"shape_dblclick",function(a){var o=zingchart.getLoader(a.id),t=ZC.P.MA(a.ev),e=o.A4M(t[0],t[1]);if(e){var i=zingchart.maps.getMapByGraphIndex(a.id,e.L);if(i){if(!i._INFO_.zooming)return;zingchart.maps.zoomToItem(i._INFO_.id,a.shapeid)}}}),zingchart.bind(null,"label_click",function(a){var o=zingchart.getLoader(a.id),t=ZC.P.MA(a.ev),e=o.A4M(t[0],t[1]);if(e){var i=zingchart.maps.getMapByGraphIndex(a.id,e.L);i&&(a.labelid===i._INFO_.id+"_zoom_in"?zingchart.maps.zoomIn(i._INFO_.id):a.labelid===i._INFO_.id+"_zoom_out"&&zingchart.maps.zoomOut(i._INFO_.id))}}),zingchart.bind(null,"mousedown",function(a){if(0===a.ev.button&&("none"===a.target||"shape"===a.target)){var o=zingchart.getLoader(a.id),t=ZC.P.MA(a.ev);a.ev.preventDefault();var e=o.A4M(t[0],t[1]);if(e){var i=zingchart.maps.getMapByGraphIndex(a.id,e.L);i&&i._INFO_.panning&&(zingchart.maps.MD=!0,zingchart.maps.REFX=a.ev.pageX,zingchart.maps.REFY=a.ev.pageY,zingchart.maps.OFFX=0,zingchart.maps.OFFY=0,zingchart.maps.REFOFFX=i._INFO_.offsetX,zingchart.maps.REFOFFY=i._INFO_.offsetY)}}}),zingchart.bind(null,"mousemove",function(a){if(zingchart.maps.MD){var o=zingchart.getLoader(a.id),t=ZC.P.MA(a.ev),e=o.A4M(t[0],t[1]);if(e){var i=zingchart.maps.getMapByGraphIndex(a.id,e.L);i&&(zingchart.maps.OFFX=zingchart.maps.REFOFFX+a.ev.pageX-zingchart.maps.REFX,zingchart.maps.OFFY=zingchart.maps.REFOFFY+a.ev.pageY-zingchart.maps.REFY,ZC._a_(zingchart.maps.REFOFFX-zingchart.maps.OFFX)+ZC._a_(zingchart.maps.REFOFFY-zingchart.maps.OFFY)>5&&(zingchart.maps.setView(a.id,i._INFO_.id,i._INFO_.zoom,zingchart.maps.OFFX,zingchart.maps.OFFY),ZC.AN.C0("maps.zoom",zingchart.getLoader(i._INFO_.loaderid),i._INFO_)))}}}),zingchart.bind(null,"mouseup",function(a){if(zingchart.maps.MD){var o=zingchart.getLoader(a.id),t=ZC.P.MA(a.ev),e=o.A4M(t[0],t[1]);e&&zingchart.maps.getMapByGraphIndex(a.id,e.L)&&(zingchart.maps.MD=!1,zingchart.maps.REFOFFX=zingchart.maps.OFFX,zingchart.maps.REFOFFY=zingchart.maps.OFFY)}}),zingchart.bind(null,"mousewheel",function(a){var o=zingchart.getLoader(a.id),t=ZC.P.MA(a.ev),e=o.A4M(t[0],t[1]);if(e){var i=zingchart.maps.getMapByGraphIndex(a.id,e.L),r=e.iX+e.I/2,n=e.iY+e.F/2;if(i){if(!i._INFO_.scrolling||a.ev.altKey)return;a.ev.preventDefault();var _,s,l=ZC.A4("#"+o.K+"-top"),p=t[0]-l.offset().left-e.iX,c=t[1]-l.offset().top-e.iY;if(a.ev.wheelDelta>0)_=zingchart.maps.getLonLat(i._INFO_.id,[p,c]),i._INFO_.zoom*=1.25,s=zingchart.maps.getXY(i._INFO_.id,_),i._INFO_.offsetX-=s[0]-p,i._INFO_.offsetY-=s[1]-c;else{var f=[(i._INFO_.bbox[0]+i._INFO_.bbox[2])/2,(i._INFO_.bbox[1]+i._INFO_.bbox[3])/2];if(_=zingchart.maps.getLonLat(i._INFO_.id,[p,c]),i._INFO_.zoom=Math.max(1,i._INFO_.zoom/1.25),i._INFO_.zoom>1.25)s=zingchart.maps.getXY(i._INFO_.id,_),i._INFO_.offsetX-=s[0]-p,i._INFO_.offsetY-=s[1]-c;else{var h=(s=zingchart.maps.getXY(i._INFO_.id,f))[0]-r,g=s[1]-n/2;i._INFO_.offsetX=h*((i._INFO_.zoom-1)/5),i._INFO_.offsetY=g*((i._INFO_.zoom-1)/5)}}zingchart.maps.setView(a.id,i._INFO_.id,i._INFO_.zoom,i._INFO_.offsetX,i._INFO_.offsetY),ZC.AN.C0("maps.zoom",zingchart.getLoader(i._INFO_.loaderid),i._INFO_)}}}),zingchart.maps.viewAll=function(A50){var oMap=zingchart.maps.maps[A50];(oMap||(oMap=eval("zingchart.maps.data."+A50)))&&zingchart.maps.zoomTo(A50,{zoom:1,offsetX:0,offsetY:0})},zingchart.maps.zoomToItem=function(A50,AAL){var oMap,BR;if(oMap=zingchart.maps.maps[A50]){if(!(BR=oMap[AAL]))return}else if(!(oMap=eval("zingchart.maps.data."+A50))||!(BR=oMap[AAL]))return;if(oMap._INFO_){var fMapW=oMap._INFO_.bbox[2]-oMap._INFO_.bbox[0],fMapH=oMap._INFO_.bbox[1]-oMap._INFO_.bbox[3],fMapCX=(oMap._INFO_.bbox[2]+oMap._INFO_.bbox[0])/2,fMapCY=(oMap._INFO_.bbox[1]+oMap._INFO_.bbox[3])/2,fItemW=BR.bbox[2]-BR.bbox[0],fItemH=BR.bbox[1]-BR.bbox[3],fItemCX=(BR.bbox[2]+BR.bbox[0])/2,fItemCY=(BR.bbox[1]+BR.bbox[3])/2,fRatio=Math.min(fMapW/fItemW,fMapH/fItemH),fZoom=fRatio,fFactorW=oMap._INFO_.width/fMapW,fFactorH=oMap._INFO_.height/fMapH,fDiffX=fMapCX-fItemCX,fDiffY=fItemCY-fMapCY,fOffX=fRatio*(fDiffX*fFactorW),fOffY=fRatio*(fDiffY*fFactorH);zingchart.maps.zoomTo(A50,{zoom:fZoom,offsetX:fOffX,offsetY:fOffY})}},zingchart.maps.zoomTo=function(A50,BA){var oMap=zingchart.maps.maps[A50]||eval("zingchart.maps.data."+A50);if(oMap){var MS={zoom:oMap._INFO_.zoom,offsetX:oMap._INFO_.offsetX,offsetY:oMap._INFO_.offsetY};zingchart.exec(oMap._INFO_.loaderid,"setobjectsmode",{mode:"flat"}),zingchart.maps.SKIP_LABELS=!0;var Y=0,R8=10,iZoomTick=window.setInterval(function(){var a="regularEaseOut",o=ZC.E9[a](Y,MS.zoom,BA.zoom-MS.zoom,R8),t=ZC.E9[a](Y,MS.offsetX,BA.offsetX-MS.offsetX,R8),e=ZC.E9[a](Y,MS.offsetY,BA.offsetY-MS.offsetY,R8);Y===R8&&(zingchart.maps.SKIP_LABELS=!1,zingchart.exec(oMap._INFO_.loaderid,"setobjectsmode",{mode:"normal"})),zingchart.maps.setView(oMap._INFO_.loaderid,A50,o,t,e),++Y>R8&&(window.clearInterval(iZoomTick),oMap._INFO_.zoom=BA.fZoom,oMap._INFO_.offsetX=BA.fOffX,oMap._INFO_.offsetY=BA.fOffY,ZC.AN.C0("maps.zoom",zingchart.getLoader(oMap._INFO_.loaderid),oMap._INFO_))},1)}},zingchart.maps.getInfo=function(A50){var oMap=zingchart.maps.maps[A50];return oMap||(oMap=eval("zingchart.maps.data."+A50)),oMap},zingchart.maps.getItems=function(A50){var oMap=zingchart.maps.maps[A50];if(oMap||(oMap=eval("zingchart.maps.data."+A50)),oMap){var B6=[];for(var sItem in oMap)"_DEFAULTS_"!==sItem&&"_INFO_"!==sItem&&"_GROUPS_"!==sItem&&"_RULES_"!==sItem&&(oMap._INFO_?-1!==ZC.AT(oMap._INFO_.items,sItem)&&B6.push(sItem):B6.push(sItem));return B6}return null},zingchart.maps.getItemInfo=function(A50,AAL){var oMap,BR;if(oMap=zingchart.maps.maps[A50]){if(BR=oMap[AAL])return BR}else if((oMap=eval("zingchart.maps.data."+A50))&&(BR=oMap[AAL]))return BR;return null},zingchart.maps.getXY=function(a,o,t){var e;if(t=t||"",e=zingchart.maps.maps[a]){var i={};return ZC._cp_(e._INFO_,i),""!==t&&ZC._cp_({map:a,item:t},i),zingchart.maps.lonlat2xy(e._INFO_.x,e._INFO_.y,e._INFO_.width,e._INFO_.height,o,e._INFO_.bbox,i)}return null},zingchart.maps.getLonLat=function(a,o){var t;return(t=zingchart.maps.maps[a])?zingchart.maps.xy2lonlat(t._INFO_.x,t._INFO_.y,t._INFO_.width,t._INFO_.height,o,t._INFO_.bbox,t._INFO_):null},zingchart.maps.registerMap=function(a,o){ZC.WI.push("maps-"+a),zingchart.maps[a]||(zingchart.maps[a]={}),zingchart.maps.data[a]||(zingchart.maps.data[a]=o),zingchart.maps.data[a]._GROUPS_={},zingchart.maps.data[a]._DEFAULTS_=zingchart.maps._DEFAULTS_,zingchart.maps[a]=function(o,t,e){return zingchart.maps.convert({loader:this,loaderdata:t||{},graphid:"undefined"==typeof o.graphid?0:o.graphid,data:e,id:o.id||a,x:"undefined"==typeof o.x?0:o.x,y:"undefined"==typeof o.y?0:o.y,width:"undefined"==typeof o.width?1:o.width,height:"undefined"==typeof o.height?1:o.height,level:"undefined"==typeof o.level?1:o.level,groups:o.groups||[],items:o.items||[],ignore:o.ignore||[],bbox:o.bbox||null,map:zingchart.maps.data[a]})}},zingchart.maps.lonlat2xy=function(iX,iY,I,F,aLonLat,aBBox,BP,bTranslate){void 0===bTranslate&&(bTranslate=!1),BP=BP||{};var iZoom=Math.abs(ZC._f_(BP.zoom||"1")),BJ=ZC._i_(BP.offsetX||"0"),BD=ZC._i_(BP.offsetY||"0"),fLonRatio=I/ZC._a_(aBBox[2]-aBBox[0]),fLatRatio=F/ZC._a_(aBBox[3]-aBBox[1]);fLonRatio*=iZoom,fLatRatio*=iZoom,iX-=I*(iZoom-1)/2,iY+=F*(iZoom-1)/2,iX+=BJ,iY+=BD;var iPx=iX+(ZC._f_(aLonLat[0])-ZC.CW(aBBox[0],aBBox[2]))*fLonRatio,iPy=iY+F-(ZC._f_(aLonLat[1])-ZC.CW(aBBox[1],aBBox[3]))*fLatRatio,oMap,BR;if(BP&&BP.map&&((oMap=zingchart.maps.maps[BP.map])||(oMap=eval("zingchart.maps.data."+BP.map)),oMap)){if((BR=oMap[BP.item])&&(iPx+=BR.transform.offsetLon*fLonRatio,iPy-=BR.transform.offsetLat*fLatRatio,1!==BR.transform.scale)){var oItemX=iX+(ZC.CW(BR.bbox[0],BR.bbox[2])-ZC.CW(aBBox[0],aBBox[2]))*fLonRatio,oItemY=iY+F-(ZC.CW(BR.bbox[1],BR.bbox[3])-ZC.CW(aBBox[1],aBBox[3]))*fLatRatio,oItemHeight=ZC._a_(BR.bbox[3]-BR.bbox[1])*fLatRatio;iPx=oItemX+(iPx-oItemX)*BR.transform.scale,iPy=oItemY-oItemHeight+(iPy-(oItemY-oItemHeight))*BR.transform.scale}bTranslate&&(iPx+=oMap._INFO_.graphinfo.graph.x,iPy+=oMap._INFO_.graphinfo.graph.y)}return[iPx,iPy]},zingchart.maps.xy2lonlat=function(a,o,t,e,i,r,n){n=n||{};var _=Math.abs(ZC._f_(n.zoom||"1")),s=ZC._i_(n.offsetX||"0"),l=ZC._i_(n.offsetY||"0");a-=t*(_-1)/2,o-=e*(_-1)/2;var p=t/ZC._a_(r[2]-r[0]),c=e/ZC._a_(r[3]-r[1]);return p*=_,c*=_,[r[0]+(i[0]-a-s)/p,r[1]+(o-i[1]+l)/c]},zingchart.maps.mappoints=function(a,o,t,e,i,r,n,_,s){var l,p,c,f,h,g,d,m=[],b=null;g=t/ZC._a_(i[2]-i[0]),d=e/ZC._a_(i[3]-i[1]),_=_||{};var C=Math.abs(ZC._f_(_.zoom||"1")),z=ZC._i_(_.offsetX||"0");g*=C,d*=C,a-=t*(C-1)/2,o-=e*(C-1)/2,o+=ZC._i_(_.offsetY||"0"),c=(a+=z)+(ZC.CW(r.bbox[0],r.bbox[2])-ZC.CW(i[0],i[2]))*g,f=o+e*C-(ZC.CW(r.bbox[1],r.bbox[3])-ZC.CW(i[1],i[3]))*d,ZC._a_(r.bbox[2]-r.bbox[0]),h=ZC._a_(r.bbox[3]-r.bbox[1])*d;for(var O=0,u=r.coords.length;O<u;O++)if(null===ZC._n_(r.coords[O]))m.push(null);else{var F=r.transform.offsetLon,Z=r.transform.offsetLat,I=r.transform.scale;if("__"===r.id&&null!==ZC._n_(n))for(var x=0,M=n.length;x<M;x++)if(r.coords[O][0]>=n[x].bbox[0]-n[x].offsetLon&&r.coords[O][0]<=n[x].bbox[2]-n[x].offsetLon&&r.coords[O][1]>=n[x].bbox[3]-n[x].offsetLat&&r.coords[O][1]<=n[x].bbox[1]-n[x].offsetLat){F=n[x].offsetLon,Z=n[x].offsetLat,I=n[x].scale,b=n[x].bbox;break}if(l=a+(r.coords[O][0]-ZC.CW(i[0],i[2]))*g+F*g,p=o+(ZC.BO(i[1],i[3])-r.coords[O][1])*d-Z*d,1!==I)if("__"===r.id){var v=a+(ZC.CW(b[0],b[2])-ZC.CW(i[0],i[2]))*g,N=o+e-(ZC.CW(b[1],b[3])-ZC.CW(i[1],i[3]))*d,L=ZC._a_(b[3]-b[1])*d;l=v+(l-v)*I,p=N-L+(p-(N-L))*I}else l=c+(l-c)*I,p=f-h+(p-(f-h))*I;null!==ZC._n_(s)?m.push([parseInt(l,10)-ZC.AM.E1,parseInt(p,10)-ZC.AM.E0,parseInt(s,10)]):m.push([parseInt(l,10),parseInt(p,10)])}return m},zingchart.maps.translate=function(a,o,t,e,i){var r=t/ZC._a_(i[2]-i[0]),n=e/ZC._a_(i[3]-i[1]);return"x"===a?o*r:o*n},zingchart.maps.convert=function(a){var o=a.data.options||{};ZC._todash_(o);var t=a.id,e=a.groups,i=a.items,r=a.ignore,n=a.bbox,_=a.level,s=!1;"01"===_&&(_=1,s=!0);var l=Math.abs(ZC._f_(o.zoom||"1")),p=ZC._i_(o["offset-x"]||"0"),c=ZC._i_(o["offset-y"]||"0"),f=!0,h=!0,g=!0;null!==ZC._n_(o.zooming)&&(f=ZC._b_(o.zooming)),null!==ZC._n_(o.panning)&&(h=ZC._b_(o.panning)),null!==ZC._n_(o.scrolling)&&(g=ZC._b_(o.scrolling));var d,m=a.loader.A4G(a.loaderdata,a.graphid);a.loader.M5&&(d=a.loader.M5.theme||"light"),a.loader.o&&(d=a.loader.o.theme||"light"),"light"===d?a.map._DEFAULTS_=zingchart.maps.LIGHT:"dark"===d&&(a.map._DEFAULTS_=zingchart.maps.DARK),ZC.AM&&(ZC.AM.A4H=2.5*ZC.BO(m.graph.width,m.graph.height),ZC.AM.E1=m.plotarea.x+m.plotarea.width/2,ZC.AM.E0=m.plotarea.y+m.plotarea.height/2);var b=ZC.ID(a.x);b=ZC._i_(b>0&&b<1?b*m.plotarea.width:b),b+=m.plotarea.x;var C=ZC.ID(a.y);C=ZC._i_(b>0&&C<1?C*m.plotarea.height:C),C+=m.plotarea.y;var z=ZC.ID(a.width);z=ZC._i_(z<=1?z*m.plotarea.width:z);var O=ZC.ID(a.height);O=ZC._i_(O<=1?O*m.plotarea.height:O);var u,F,Z,I={};if(ZC._cp_(a.map,I),0===z||0===O||!I)return[];for(u in I)"_DEFAULTS_"!==u&&"_INFO_"!==u&&"_GROUPS_"!==u&&"_RULES_"!==u&&(null===ZC._n_(I[u].transform)&&(I[u].transform={offsetLon:0,offsetLat:0,scale:1}),null===ZC._n_(I[u].connector)&&(I[u].connector={points:[],anchor:""}));var x;for(u in I)if("_DEFAULTS_"!==u&&"_INFO_"!==u&&"_GROUPS_"!==u&&"_RULES_"!==u&&!(0===_&&"__"!==u||0!==_&&"__"===u&&!s)){x=[ZC.MAX,-ZC.MAX,-ZC.MAX,ZC.MAX];var M=I[u].transform.offsetLon,v=I[u].transform.offsetLat,N=I[u].transform.scale;for(F=0;F<I[u].coords.length;F++)if(null!==ZC._n_(I[u].coords[F])){if("__"===u&&null!==ZC._n_(I._RULES_))for(var L=0,A=I._RULES_.length;L<A;L++)if(I[u].coords[F][0]>=I._RULES_[L].bbox[0]-I._RULES_[L].offsetLon&&I[u].coords[F][0]<=I._RULES_[L].bbox[2]-I._RULES_[L].offsetLon&&I[u].coords[F][1]>=I._RULES_[L].bbox[3]-I._RULES_[L].offsetLat&&I[u].coords[F][1]<=I._RULES_[L].bbox[1]-I._RULES_[L].offsetLat){M=I._RULES_[L].offsetLon,v=I._RULES_[L].offsetLat,N=I._RULES_[L].scale;break}x[0]=ZC.CW(x[0],I[u].coords[F][0]+M),x[1]=ZC.BO(x[1],I[u].coords[F][1]+v),x[2]=ZC.BO(x[2],I[u].coords[F][0]+M),x[3]=ZC.CW(x[3],I[u].coords[F][1]+v)}1!==N&&"__"!==u&&(x[2]=x[0]+(x[2]-x[0])*N,x[3]=x[1]-(x[1]-x[3])*N),I[u].id=u,I[u].bbox=x}x=[ZC.MAX,-ZC.MAX,-ZC.MAX,ZC.MAX];var y=[];if(e.length>0&&I._GROUPS_){for(F=0,Z=e.length;F<Z;F++)I._GROUPS_[e[F]]&&(y=y.concat(I._GROUPS_[e[F]]));for(F=y.length-1;F>=0;F--)if(-1===y[F].indexOf("@"))-1!==ZC.AT(r,y[F])&&y.splice(F,1);else{var R=y[F].split("@");-1!==ZC.AT(r,R[0])&&y.splice(F,1)}}if(i.length>0)for(F=0,Z=i.length;F<Z;F++)-1===ZC.AT(r,i[F])&&y.push(i[F]);else for(u in I)if(I.hasOwnProperty(u)){if("_DEFAULTS_"===u||"_INFO_"===u||"_GROUPS_"===u||"_RULES_"===u)continue;if(0===_&&"__"!==u||0!==_&&"__"===u&&!s)continue;0===e.length&&-1===ZC.AT(r,u)&&y.push(u)}for(F=y.length-1;F>=0;F--)if(y[F]&&-1!==y[F].indexOf("@")){var B=y[F].split("@");-1!==ZC.AT(y,B[0])&&y.splice(F,1)}if(null!==ZC._n_(n)&&4===n.length)x=n;else for(F=0,Z=y.length;F<Z;F++)I[u=y[F]]&&(x[0]=ZC.CW(x[0],I[u].bbox[0]),x[1]=ZC.BO(x[1],I[u].bbox[1]),x[2]=ZC.BO(x[2],I[u].bbox[2]),x[3]=ZC.CW(x[3],I[u].bbox[3]));var E=ZC._a_(x[2]-x[0])/20,S=ZC._a_(x[3]-x[1])/20;x[0]-=E,x[1]+=S,x[2]+=E,x[3]-=S;for(u in I)"_DEFAULTS_"!==u&&"_INFO_"!==u&&"_GROUPS_"!==u&&"_RULES_"!==u&&(0===_&&"__"!==u||0!==_&&"__"===u&&!s||(E=ZC.CW(1,ZC._a_(I[u].bbox[2]-I[u].bbox[0])/8),S=ZC.CW(1,ZC._a_(I[u].bbox[3]-I[u].bbox[1])/8),I[u].bbox[0]-=E,I[u].bbox[1]+=S,I[u].bbox[2]+=E,I[u].bbox[3]-=S));var X,Y=1+.8*ZC._a_((x[3]+x[1])/180),w=z/ZC._a_(x[2]-x[0]),D=O/ZC._a_(x[3]-x[1]);if(!o.hasOwnProperty("scale")||ZC._b_(o.scale)){if((X=Y*w/D)>1.05){var P=ZC._i_(z/X);b+=(z-P)/2,z=P}else if(X<.95){var U=ZC._i_(O*X);C+=(O-U)/2,O=U}w=z/ZC._a_(x[2]-x[0]),D=O/ZC._a_(x[3]-x[1])}for(var T in zingchart.maps.maps)if(t!==T){var k=zingchart.maps.maps[T];k&&k._INFO_&&k._INFO_.graphinfo&&k._INFO_.graphinfo.graph&&k._INFO_.graphinfo.graph.index===m.graph.index&&(k._INFO_.graphinfo.graph.index=-1)}I._INFO_={loaderid:a.loader.K,x:b,y:C,zoom:l,zooming:f,panning:h,scrolling:g,offsetX:p,offsetY:c,width:z,height:O,id:t,bbox:x,groups:e,items:y,ignore:r,graphinfo:m},3*y.length>zingchart.DEV.MAXPOOLSIZE&&(zingchart.DEV.MAXPOOLSIZE+=3*y.length),zingchart.maps.maps[t]=I;var W,G={},H={};if(W=o.choropleth){var j,V=ZC.MAX,K=-ZC.MAX,J="";for(F=0,Z=y.length;F<Z;F++)u=y[F],null!==ZC._n_(o.style)&&null!==ZC._n_(o.style.items)&&null!==ZC._n_(o.style.items[u])&&null!==ZC._n_(o.style.items[u]["data-value"])&&(j=ZC._f_(o.style.items[u]["data-value"]),V=Math.min(V,j),K=Math.max(K,j),H[u]={"data-value":j});var Q=W.aspect||"gradient",q=W.progression||"lin",$=W.intervals||4,aa=W.color||"#336699",oa=W["max-percent"]||50,ta=W.effect||"lighten",ea=ZC._b_(W.mirrored),ia=oa/(K-V);"log"===q&&(ia=oa/(ZC.H9(K,10)-ZC.H9(V,10)));var ra=oa/$,na=W.labels||[],_a=W.steps||[],sa=W.colors||[];if("intervals"===Q){if(_a.length)$=_a.length-1;else if("lin"===q){var la=(K-V)/$;for(F=0;F<$;F+=1)_a.push(V+F*la);_a.push(K)}else{var pa=Math.floor(ZC.H9(V,10)),ca=Math.ceil(ZC.H9(K,10));for(pa===ca&&ca++,$=Math.max(1,ca-pa-1),F=pa;F<=ca;F+=1)F===pa&&pa<1?_a.push(0):_a.push(Math.pow(10,F));ra=oa/$}if(!sa.length)for(F=0;F<=$;F+=1)sa.push("lighten"===ta?ZC.AN.QQ(aa,F*ra):ZC.AN.JE(aa,F*ra))}for(F=0,Z=y.length;F<Z;F++)if(u=y[F],H[u]){if(j=H[u]["data-value"],"gradient"===Q){var fa=ZC._i_((j-V)*ia);"log"===q&&(fa=ZC._i_((ZC.H9(j,10)-ZC.H9(V,10))*ia)),ea&&(fa=oa-fa),J="lighten"===ta?ZC.AN.QQ(aa,fa):ZC.AN.JE(aa,fa)}else if("intervals"===Q){for(var ha=0;ha<_a.length-1;ha++)if(j>=_a[ha]&&j<_a[ha+1]){J=sa[ha];break}""===J&&j===K&&(J=sa[sa.length-1])}H[u]={"data-color":J,"background-color":J,"hover-state":{"background-color":J}},W["override-tooltip"]&&(H[u].tooltip={"background-color":ZC.AN.JE(J,15)})}I._INFO_.choropleth={aspect:Q,progression:q,intervals:$,color:aa,maxPercent:oa,effect:ta,minValue:V,maxValue:K,steps:_a,colors:sa,labels:na,mirrored:ea}}for(o["color-scale"]&&(I._INFO_["color-scale"]=!0),F=0,Z=y.length;F<Z;F++)if(u=y[F],I[u]){var ga=I[u].type||"poly",da=0;"line"!==ga&&"point"!==ga||(da+=10),I[u].sort&&(I[u].sort&&(I[u].sort=.5),da+=I[u].sort);var ma=null;if(null!==ZC._n_(o.style)&&(o.style["3d"]&&(ma=1),null!==ZC._n_(o.style.z)&&(ma=o.style.z),null!==ZC._n_(o.style.items)&&null!==ZC._n_(o.style.items[u])&&null!==ZC._n_(o.style.items[u].z)&&(ma=o.style.items[u].z)),"poly"===ga||"line"===ga)G[u]={type:ga,id:u,points:zingchart.maps.mappoints(b,C,z,O,x,I[u],I._RULES_,I._INFO_,ma),label:{map:t},"z-sort":da,"z-index":da,tooltip:{},connector:{},"map-item":!0,generated:!0};else if("point"===ga){var ba=zingchart.maps.mappoints(b,C,z,O,x,I[u],I._RULES_,I._INFO_,ma);G[u]={type:"circle",id:u,size:5,x:ba[0][0],y:ba[0][1],label:{map:t},"z-sort":da,"z-index":da,tooltip:{},connector:{},"map-item":!0,generated:!0}}var Ca,za,Oa;if("poly"===ga||"line"===ga){var ua=zingchart.maps.centroid(G[u].points);za=ua[0],Oa=ua[1],Ca=ua[2]}I._DEFAULTS_&&(ZC._cp_(I._DEFAULTS_._COMMON_,G[u]),"poly"===ga?ZC._cp_(I._DEFAULTS_._POLY_,G[u]):"line"===ga?ZC._cp_(I._DEFAULTS_._LINE_,G[u]):"point"===ga&&ZC._cp_(I._DEFAULTS_._POINT_,G[u])),I[u].style&&ZC._cp_(I[u].style,G[u]),ZC._todash_(G[u]);var Fa=I[u].label.text,Za=I[u].tooltip.text;ZC._cp_(o.style,G[u],null,null,null,["items"]);var Ia=I[u].tooltip.text||"",xa=G[u].tooltip.text||"";ZC._cp_(I[u].tooltip,G[u].tooltip);var Ma=G[u].label.text;ZC._cp_(I[u].label,G[u].label),Ma&&(G[u].label.text=Ma),1===zingchart.maps.CONNECTORS&&ZC._cp_(I[u].connector,G[u].connector),"poly"!==ga&&"line"!==ga||"auto"===G[u].label.visible&&Ca<400&&(0===zingchart.maps.CONNECTORS||0===G[u].connector.points.length)&&(G[u].label.visible=!1),H[u]&&ZC._cp_(H[u],G[u]);var va=!1;null!==ZC._n_(o.style)&&null!==ZC._n_(o.style.items)&&(ZC._cp_(o.style.items[u],G[u]),o.style.items[u]&&o.style.items[u].tooltip&&o.style.items[u].tooltip.text&&(Ia=o.style.items[u].tooltip.text,-1===xa.indexOf("%text")&&(va=!0))),G[u].tooltip.text=""===xa||va?Ia:xa.replace("%text",Ia);for(var Na in G[u])"data-"===Na.substring(0,5)&&(G[u].tooltip.text=G[u].tooltip.text.replace("%"+Na,G[u][Na]),G[u].label.text=G[u].label.text.replace("%"+Na,G[u][Na]));if(G[u].tooltip.text=G[u].tooltip.text.replace("%short-text",Fa).replace("%long-text",Za),G[u].label.text=G[u].label.text.replace("%short-text",Fa).replace("%long-text",Za),zingchart.maps.CONNECTORS&&null!==ZC._n_(G[u].connector.points)){for(var La=0,Aa=G[u].connector.points.length;La<Aa;La++)G[u].connector.points[La]=zingchart.maps.lonlat2xy(b,C,z,O,G[u].connector.points[La],x,{zoom:l,offsetX:p,offsetY:c});G[u].connector.points=ZC.AN.A4Y(G[u].connector.points,m.graph.x,m.graph.y)}null===ZC._n_(G[u].label.x)&&(G[u].label.x=za+m.graph.x),null===ZC._n_(G[u].label.y)&&(G[u].label.y=Oa+m.graph.y)}var ya=m.graph.width,Ra=m.graph.height;o.style=o.style||{};var Ba=o.style.controls||{};if(null===ZC._n_(Ba.visible)||ZC._b_(Ba.visible)){var Ea=ZC._i_(Ba.x||"-1"),Sa=ZC._i_(Ba.y||"-1"),Xa=Ba.placement||"";""!==Xa||-1!==Ea&&-1!==Sa||(Xa="tl");switch(Xa){case"tl":Ea=10,Sa=10;break;case"tr":Ea=0+ya-25-10,Sa=10;break;case"bl":Ea=10,Sa=0+Ra-50-10;break;case"br":Ea=0+ya-25-10,Sa=0+Ra-50-10}G._ZOOM_IN_={objtype:"label",id:I._INFO_.id+"_zoom_in",generated:!0,x:Ea,y:Sa,width:25,height:25,"border-width":1,"border-color":"#999","background-color":"#eee","border-radius":"2 2 0 0","font-size":17,text:"+",tooltip:{text:"Zoom In"}},ZC._cp_(zingchart.maps._DEFAULTS_._COMMON_.tooltip,G._ZOOM_IN_.tooltip),ZC._cp_(Ba["zoom-in"],G._ZOOM_IN_),G._ZOOM_OUT_={objtype:"label",id:I._INFO_.id+"_zoom_out",generated:!0,x:Ea,y:Sa+25-1,width:25,height:25,"border-width":1,"border-color":"#999","background-color":"#eee","border-radius":"0 0 2 2","font-size":17,text:"-",tooltip:{text:"Zoom Out"}},ZC._cp_(zingchart.maps._DEFAULTS_._COMMON_.tooltip,G._ZOOM_OUT_.tooltip),ZC._cp_(Ba["zoom-out"],G._ZOOM_OUT_)}return G},zingchart.maps.exportMap=function(a,o){var t=["ZC.WI.push('maps-{{exportid}}');","","(function() {","","if (!zingchart.maps.{{exportid}}) {","zingchart.maps.{{exportid}} = {};","};","","if (!zingchart.maps.data.{{exportid}}) {","zingchart.maps.data.{{exportid}} = {};","};","","var _COORDS_ = {","{{coords}}","};","","zingchart.maps.data.{{exportid}} = {","_GROUPS_:{","{{groups}}","},","_DEFAULTS_:zingchart.maps._DEFAULTS_,","{{items}}","};","","zingchart.maps.upgrade('{{exportid}}');","","})();","","zingchart.maps.{{exportid}} = function(p, ld, d) {","return zingchart.maps.convert({","loader:this,","loaderdata:ld || {},","graphid:((typeof(p.graphid) == 'undefined')?0:p.graphid),","data:d,","id:p.id || '{{exportid}}',","x:((typeof(p.x) == 'undefined')?0:p.x),","y:((typeof(p.y) == 'undefined')?0:p.y),","width:((typeof(p.width) == 'undefined')?1:p.width),","height:((typeof(p.height) == 'undefined')?1:p.height),","level:((typeof(p.level) == 'undefined')?1:p.level),","groups:p.groups || [],","items:p.items || [],","ignore:p.ignore || [],","bbox:p.bbox || null,","map:zingchart.maps.data.{{exportid}}","});","}"].join("\n"),e=["'{{id}}':{","coords:_COORDS_['{{id}}'],","tooltip:{","text:'{{text}}'","},","label:{","text:'{{id}}'","}","}"].join("\n"),i=t;i=i.replace(/\{\{exportid\}\}/gi,o);var r=[],n=[],_=[],s=zingchart.maps.data[a];for(var l in s._GROUPS_){var p='"'+l+'":["'+s._GROUPS_[l].join('","')+'"]';n.push(p)}for(var c in s)if("_DEFAULTS_"!==c&&"_GROUPS_"!==c){var f=e;f=(f=f.replace(/\{\{id\}\}/g,c)).replace(/\{\{text\}\}/g,s[c].tooltip.text),_.push(f);for(var h='"'+c+'":',g=[],d=0;d<s[c].coords.length;d++)s[c].coords[d]?g.push([s[c].coords[d][0].toFixed(3),s[c].coords[d][1].toFixed(3)]):g.push(null);h+=JSON.stringify(g).replace(/\"/g,""),r.push(h)}return i=i.replace(/\{\{coords\}\}/gi,r.join(",\n")),i=i.replace(/\{\{groups\}\}/gi,n.join(",\n")),i=i.replace(/\{\{items\}\}/gi,_.join(",\n"))};